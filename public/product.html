<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Details</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">



  <div class="container my-4">
  <div id="back-button-container"></div> <!-- placeholder for Go Back button -->
  <div id="product-container" class="card shadow-lg p-4">
    <!-- Product details will load here -->
  </div>
</div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const params = new URLSearchParams(window.location.search);
    const productId = params.get("id");

    async function loadProduct() {
      try {
        const res = await fetch(`/api/products/${productId}`);
        if (!res.ok) throw new Error("Product not found");
        const product = await res.json();

        // Carousel items
        const carouselItems = product.images.map((img, index) => `
          <div class="carousel-item ${index === 0 ? 'active' : ''}">
            <img src="${img}" class="d-block w-100 rounded" alt="Product image">
          </div>
        `).join("");

        document.getElementById("product-container").innerHTML = `
          <div class="row">
            <!-- Product images carousel -->
            <div class="col-md-6">
              <div id="carouselExample" class="carousel slide">
                <div class="carousel-inner">
                  ${carouselItems}
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
                  <span class="carousel-control-prev-icon"></span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
                  <span class="carousel-control-next-icon"></span>
                </button>
              </div>
            </div>

            <!-- Product details -->
            <div class="col-md-6">
              <h2>${product.name}</h2>
              <p class="text-muted">Brand: ${product.brand} | Category: ${product.category}</p>
              <h4 class="text-success">
                $${product.price.toFixed(2)} 
                <small class="text-decoration-line-through text-muted">$${product.originalPrice.toFixed(2)}</small>
              </h4>
              <p>${product.description}</p>
              <ul>
                ${product.features.map(f => `<li>${f}</li>`).join("")}
              </ul>
              <button class="btn btn-primary mt-3" onclick="addToCart('${product.id}')">Add to Cart</button>
            </div>
          </div>
        `;
      } catch (err) {
        document.getElementById("product-container").innerHTML = `<p class="text-danger">${err.message}</p>`;
      }
    }

    async function addToCart(productId) {
      const res = await fetch("/api/cart", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ productId, quantity: 1 })
      });
      const data = await res.json();
      alert(data.message || "Added to cart");
    }

 function addGoBackButton() {
    const container = document.getElementById("back-button-container");
    const button = document.createElement("button");
    button.className = "btn btn-secondary mb-3";
    button.innerText = "← Back to Products";
    button.onclick = () => window.location.href = "http://localhost:3000/api"; // your target URL
    container.appendChild(button);
  }

  addGoBackButton();
    loadProduct();
  </script>
</body>
</html>
